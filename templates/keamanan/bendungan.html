{% extends 'layouts/master.html' %}

{% set title = "Keamanan" %}

{% block css %}
<style media="screen">
    a[aria-expanded=true] .fa-chevron-down {
       display: none;
    }
    a[aria-expanded=false] .fa-chevron-up {
       display: none;
    }
</style>
{% endblock %}

{% block content %}
    <!-- Computer View -->
    <section class="content-header d-none d-sm-block">
        <h1>{{ waduk.nama }} Keamanan</h1>
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item">{{ waduk.nama }}</li>
        </ol>
    </section>

    <!-- Mobile View -->
    <section class="content-header d-block d-sm-none">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item">{{ waduk.nama }}</li>
        </ol>
        <h3>{{ waduk.nama }} Keamanan</h3>
    </section>
    <hr>
    <div class="row">
        <div class="col-md-6">
            <section class="content-header">
                <h3>VNotch
                    <a class="ml-5 btn-sm btn btn-outline-primary"
                        data-toggle="collapse" href="#form-add-vnotch"
                        role="button" aria-expanded="false"
                        aria-controls="">
                        Tambah
                    </a>
                </h3>
            </section>
            <div class="row container collapse" id="form-add-vnotch">
                <form method="POST" action="{{ path_for('keamanan.vnotch.add', {'id': waduk.id}, {'sampling': sampling}) }}">
                    <div class="form-control">
                        <span id="datepicker"><i class="fas fa-calendar mr-2 text-right"></i> {{ sampling }}</span>
                    </div>
                    <br>
                    {% for v in vnotch %}
                        <h3>{{ v.nama }}</h3>
                        <div class="row">
                            <div class="form-group col-md-6">
                                <label for="tma-{{ v.id }}">Tinggi Muka Air</label>
                                <input id="tma-{{ v.id }}" name="tma-{{ v.id }}" autofocus required class="form-control" type="number" step="0.1" value="">
                            </div>
                            <div class="form-group col-md-6">
                                <label for="debit-{{ v.id }}">Debit Air</label>
                                <input id="debit-{{ v.id }}" name="debit-{{ v.id }}" autofocus required class="form-control" type="number" step="0.1" value="">
                            </div>
                        </div>
                        <hr>
                    {% endfor %}
                  <div class="form-group">
                    <input type="submit" class="btn btn-primary">
                  </div>
                </form>
            </div>
        </div>
        <div class="col-md-6">
            <section class="content-header">
                <h3>Piezometer
                    <a class="ml-5 btn-sm btn btn-outline-primary"
                        data-toggle="collapse" href="#form-add-piezometer"
                        role="button" aria-expanded="false"
                        aria-controls="">
                        Tambah
                    </a>
                </h3>
            </section>
            <div class="row container collapse" id="form-add-piezometer">
                <form method="POST" action="{{ path_for('keamanan.piezometer.add', {'id': waduk.id}, {'sampling': sampling}) }}">
                    <div class="form-control">
                        <span id="datepicker2"><i class="fas fa-calendar mr-2 text-right"></i> {{ sampling }}</span>
                    </div>
                    <br>
                    {% for p in piezometer %}
                        <h3>{{ p.nama }}</h3>
                        <div class="row">
                            <div class="form-group col-md-12">
                                <label for="tma-{{ p.id }}">Tinggi Muka Air</label>
                                <input id="tma-{{ p.id }}" name="tma-{{ p.id }}" autofocus required class="form-control" type="number" step="0.1" value="">
                            </div>
                        </div>
                        <hr>
                    {% endfor %}
                  <div class="form-group">
                    <input type="submit" class="btn btn-primary">
                  </div>
                </form>
            </div>
        </div>
    </div>
    <hr>
    {% for t, per in periodik %}
        <h6>
            <b>{{ t }}</b>
            <span>|</span>
            <span style="color: {% if per.vnotch %}blue{% else %}red{% endif %};">VNotch</span>
            <span>|</span>
            <span style="color: {% if per.piezometer %}blue{% else %}red{% endif %};">Piezometer</span>
            <a class="ml-3"
                data-toggle="collapse" href="#periodik-{{ per.id }}"
                role="button" aria-expanded="false"
                aria-controls="">
                <i class="fa fa-chevron-up pull-right"></i>
                <i class="fa fa-chevron-down pull-right"></i>
            </a>
        </h6>
        <div class="row container collapse" id="periodik-{{ per.id }}">
            <div class="col-md-6">
                <h5>VNotch</h5>
                <div class="ml-3">
                    {% if per.vnotch %}
                        {% for v in per.vnotch %}
                            <p><b>{{ v.nama }}</b></p>
                            <div class="row ml-3">
                                <div class="col-md-6">
                                    <p>TMA : {{ v.tma }}</p>
                                </div>
                                <div class="col-md-6">
                                    <p>Debit : {{ v.debit }}</p>
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <p style="color: red;"><b>Belum Ada Data</b></p>
                    {% endif %}
                </div>
            </div>
            <div class="col-md-6">
                <h5>Piezometer</h5>
                <div class="ml-3">
                    {% if per.piezometer %}
                        {% for p in per.piezometer %}
                            <p><b>{{ p.nama }}</b></p>
                            <div class="ml-3">
                            <p>TMA : {{ p.tma }}</p>
                            </div>
                        {% endfor %}
                    {% else %}
                        <p style="color: red;"><b>Belum Ada Data</b></p>
                    {% endif %}
                </div>
            </div>
        </div>
    {% endfor %}
{% endblock %}

{% block js %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
    <script>
        $('#datepicker').datepicker({
            todayHighlight: true,
            autoclose: true,
            format: 'yyyy-mm-dd'
        });
        $('#datepicker').on('changeDate', function () {
            window.location = "{{ path_for('keamanan.bendungan', {'id': waduk.id}) }}?sampling=" + $('#datepicker').datepicker('getFormattedDate')
        });

        $('#datepicker2').datepicker({
            todayHighlight: true,
            autoclose: true,
            format: 'yyyy-mm-dd'
        });
        $('#datepicker2').on('changeDate', function () {
            window.location = "{{ path_for('keamanan.bendungan', {'id': waduk.id}) }}?sampling=" + $('#datepicker2').datepicker('getFormattedDate')
        });
    </script>
{% endblock %}
