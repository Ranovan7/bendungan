{% extends 'layouts/master.html' %}

{% set title = "Keamanan" %}

{% block css %}
<style media="screen">
    a[aria-expanded=true] .fa-chevron-down {
       display: none;
    }
    a[aria-expanded=false] .fa-chevron-up {
       display: none;
    }
</style>
<link href="{{ asset('css/bootstrap-editable.css') }}" rel="stylesheet"/>
{% endblock %}

{% block content %}
    <section class="content-header">
        <h2>{{ waduk.nama }}</h2>
    </section>
    <hr>
    <div class="row">
        <div class="col-md-6">
            <section class="content-header">
                <h4>
                    VNotch
                    <a class="ml-5"
                        data-toggle="collapse" href="#form-add-vnotch"
                        role="button" aria-expanded="false"
                        aria-controls="">
                        <i class="fas fa-plus mr-2"></i>
                    </a>
                </h4>
            </section>
            <div class="row collapse" id="form-add-vnotch" style="padding-left: 25px; padding-right: 25px;">
                <form method="POST" action="{{ path_for('keamanan.vnotch.add', {'id': waduk.id}, {'sampling': sampling}) }}">
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label class="form-text" for="sampling">Tanggal</label>
                            <div class="input-group">
                                <span class="input-group-addon" id="calendar_addon"><i class="fas fa-calendar mr-2 text-right"></i></span>
                                <input class="form-control" type="text" name="sampling" id="sampling" required value="{{ sampling }}" aria-describedby="calendar_addon">
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>VNotch 1</h3>
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label for="tma-vn1">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="tma-vn1" name="tma-vn1"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="debit-vn1">Debit Air</label>
                            <div class="input-group">
                                <input id="debit-vn1" name="debit-vn1" class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="debit-append">m<sup>3</sup>/detik</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>VNotch 2</h3>
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label for="tma-vn2">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="tma-vn2" name="tma-vn2" class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="debit-vn2">Debit Air</label>
                            <div class="input-group">
                                <input id="debit-vn2" name="debit-vn2" class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="debit-append">m<sup>3</sup>/detik</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>VNotch 3</h3>
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label for="tma-vn3">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="tma-vn3" name="tma-vn3" class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="debit-vn3">Debit Air</label>
                            <div class="input-group">
                                <input id="debit-vn3" name="debit-vn3" class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="debit-append">m<sup>3</sup>/detik</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                  <div class="form-group">
                    <input type="submit" class="btn btn-primary" value="Tambah">
                  </div>
                </form>
            </div>
        </div>
        <div class="col-md-6">
            <section class="content-header">
                <h4>
                    Piezometer
                    <a class="ml-5"
                        data-toggle="collapse" href="#form-add-piezometer"
                        role="button" aria-expanded="false"
                        aria-controls="">
                        <i class="fas fa-plus mr-2"></i>
                    </a>
                </h4>
            </section>
            <div class="row collapse" id="form-add-piezometer"  style="padding-left: 25px; padding-right: 25px;">
                <form method="POST" action="{{ path_for('keamanan.piezometer.add', {'id': waduk.id}) }}">
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label class="form-text" for="sampling">Tanggal</label>
                            <div class="input-group">
                                <span class="input-group-addon" id="calendar_addon"><i class="fas fa-calendar mr-2 text-right"></i></span>
                                <input class="form-control" type="text" name="sampling" id="sampling2" required value="{{ sampling }}" aria-describedby="calendar_addon">
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 1A</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p1a">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p1a" name="p1a"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 1B</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p1b">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p1b" name="p1b"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 1C</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p1c">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p1c" name="p1c"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 2A</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p2a">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p2a" name="p2a"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 2B</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p2b">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p2b" name="p2b"  class="form-control" type="number" step="0.1" value="">
                                <div cla2s="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 2C</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p2c">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p2c" name="p2c"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 3A</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p3a">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p3a" name="p3a"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 3B</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p3b">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p3b" name="p3b"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 3C</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p3c">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p3c" name="p3c"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 4A</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p4a">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p4a" name="p4a"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 4B</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p4b">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p4b" name="p4b"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 4C</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p4c">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p4c" name="p4c"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 5A</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p5a">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p5a" name="p5a"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 5B</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p5b">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p5b" name="p5b"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <h3>Piezo 5C</h3>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <label for="p5c">Tinggi Muka Air</label>
                            <div class="input-group">
                                <input id="p5c" name="p5c"  class="form-control" type="number" step="0.1" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text" id="tma-append">m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                  <div class="form-group">
                    <input type="submit" class="btn btn-primary" value="Tambah">
                  </div>
                </form>
            </div>
        </div>
    </div>
    <h3>
        Data Keamanan
        <span id="datepicker" style="color: #18bc9c"> {{ sampling | date('M Y') }}</span>
    </h3>
    <hr>
    <table class="table table-bordered table-stripped">
        <thead>
            <tr class="active">
              <th rowspan="2" style="vertical-align:middle;">Tanggal</th>
              <th colspan="2" style="vertical-align:middle;">VNotch (L/det)</th>
              <th colspan="15" style="vertical-align:middle;">Piezometer (m)</th>
            </tr>
            <tr class="active">
              <th style="vertical-align:middle;">Tinggi</th>
              <th style="vertical-align:middle;">Debit</th>
              <th style="vertical-align:middle;">Piezo 1A</th>
              <th style="vertical-align:middle;">Piezo 1B</th>
              <th style="vertical-align:middle;">Piezo 1C</th>
              <th style="vertical-align:middle;">Piezo 2A</th>
              <th style="vertical-align:middle;">Piezo 2B</th>
              <th style="vertical-align:middle;">Piezo 2C</th>
              <th style="vertical-align:middle;">Piezo 3A</th>
              <th style="vertical-align:middle;">Piezo 3B</th>
              <th style="vertical-align:middle;">Piezo 3C</th>
              <th style="vertical-align:middle;">Piezo 4A</th>
              <th style="vertical-align:middle;">Piezo 4B</th>
              <th style="vertical-align:middle;">Piezo 4C</th>
              <th style="vertical-align:middle;">Piezo 5A</th>
              <th style="vertical-align:middle;">Piezo 5B</th>
              <th style="vertical-align:middle;">Piezo 5C</th>
            </tr>
        </thead>
        <tbody>
            {% for d, per in periodik %}
                <tr>
                    <td align="right">{{ d }}</td>
                    <td align="right">{{ per.vnotch.vn1_tma }}</td>
                    <td align="right">{{ per.vnotch.vn1_debit }}</td>
                    <td align="right">{% if per.piezo.p1a %}{{ per.piezo.p1a }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p1b %}{{ per.piezo.p1b }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p1c %}{{ per.piezo.p1c }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p2a %}{{ per.piezo.p2a }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p2b %}{{ per.piezo.p2b }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p2c %}{{ per.piezo.p2c }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p3a %}{{ per.piezo.p3a }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p3b %}{{ per.piezo.p3b }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p3c %}{{ per.piezo.p3c }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p4a %}{{ per.piezo.p4a }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p4b %}{{ per.piezo.p4b }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p4c %}{{ per.piezo.p4c }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p5a %}{{ per.piezo.p5a }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p5b %}{{ per.piezo.p5b }}{% else %}-{% endif %}</td>
                    <td align="right">{% if per.piezo.p5c %}{{ per.piezo.p5c }}{% else %}-{% endif %}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}

{% block js %}
    <script src="{{ asset('js/bootstrap-editable.min.js') }}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
    <script>
        // resolve package confict
        let datepicker = $.fn.datepicker.noConflict();
        $.fn.bootstrapDP = datepicker;

        $('#datepicker').datepicker({
            autoclose: true,
            format: 'yyyy-mm-dd',
            startView: "months",
            minViewMode: "months"
        });
        $('#datepicker').on('changeDate', function () {
            window.location = "{{ path_for('keamanan.bendungan', {'id': waduk.id}) }}?sampling=" + $('#datepicker').datepicker('getFormattedDate')
        });

        $('#sampling').datepicker({
            todayHighlight: true,
            autoclose: true,
            format: 'yyyy-mm-dd'
        });

        $('#sampling2').datepicker({
            todayHighlight: true,
            autoclose: true,
            format: 'yyyy-mm-dd'
        });

        //turn to popup mode
        $.fn.editable.defaults.mode = 'popup';
        $(document).ready(function() {
            $('.editable').editable();
        });
    </script>
{% endblock %}
